<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0085)https://docs.google.com/forms/d/1-03gpOzsKEKZd_2ZRMhpi0ZafW0roA0J0x6ZIU_IWns/viewform -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="shortcut icon" href="https://ssl.gstatic.com/docs/spreadsheets/forms/favicon_qp2.png" type="image/x-icon">

<meta http-equiv="X-UA-Compatible" content="IE=10; chrome=1;">
<meta name="fragment" content="!">
<meta name="viewport" content="width=device-width">
<base href="." target="_blank">
    
<title>行程規劃</title>

<link rel="stylesheet" type="text/css" href="./resource/css">
<link href="./resource/2131000577-formview_st_ltr.css" type="text/css" rel="stylesheet">
<link href="./resource/3145455273-mobile_formview_st_ltr.css" type="text/css" rel="stylesheet" media="screen and (max-device-width: 721px)">
    
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/eggplant/jquery-ui.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.11.3/jquery-ui.min.js"></script>

<style type="text/css">
body {
  background-color: rgb(231,238,247);
  background-image: url('./resource/blue-stripe-bg.png');
  background-repeat: repeat;
  background-position: left top;
}

.ss-form-container, .ss-resp-card {
  background-color: rgb(255,255,255);
}

.ss-footer, .ss-response-footer {
  background-color: rgb(255,255,255);
}

.ss-grid-row-odd {
  background-color: rgb(242,242,242);
}

.ss-form-container, .ss-resp-card {
  border-color: rgb(212,212,212);
}

.ss-form-title {
  text-align: left;
}

.ss-form-title[dir="rtl"] {
  text-align: right;
}

.ss-form-desc {
  text-align: left;
}

.ss-form-desc[dir="rtl"] {
  text-align: right;
}

.ss-header-image-container {
  height: 0;
}

.ss-item {
  font-size: 1.080rem;
}

.ss-choices {
  font-size: 1.000rem;
}

body {
  font-family: "Roboto";
  color: rgb(119,119,119);
  font-weight: 400;
  font-size: 1.080rem;
  font-style: normal;
}

.ss-record-username-message {
  font-family: "Roboto";
  color: rgb(119,119,119);
  font-weight: 400;
  font-size: 1.080rem;
  font-style: normal;
}

.ss-form-title {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 2.460rem;
  font-style: normal;
}

.ss-confirmation {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 2.460rem;
  font-style: normal;
}

.ss-page-title, .ss-section-title {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 1.845rem;
  font-style: normal;
}

.ss-form-desc, .ss-page-description, .ss-section-description {
  font-family: "Roboto";
  color: rgb(140,140,140);
  font-weight: 400;
  font-size: 1.080rem;
  font-style: normal;
}

.ss-resp-content {
  font-family: "Roboto";
  color: rgb(119,119,119);
  font-weight: 400;
  font-size: 1.080rem;
  font-style: normal;
}

.ss-q-title {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 700;
  font-size: 1.080rem;
  font-style: normal;
}

.ss-embeddable-object-container .ss-q-title {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 700;
  font-size: 1.845rem;
  font-style: normal;
}

.ss-q-help, .ss-q-time-hint {
  font-family: "Roboto";
  color: rgb(140,140,140);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

.ss-choice-label, .video-secondary-text, .ss-gridrow-leftlabel, .ss-gridnumber, .ss-scalenumber, .ss-leftlabel, .ss-rightlabel {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

.error-message, .required-message, .ss-required-asterisk {
  font-family: "Roboto";
  color: rgb(196,59,29);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

.ss-send-email-receipt {
  font-family: "Roboto";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

.ss-password-warning {
  font-family: "Arial";
  color: rgb(119,119,119);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: italic;
}

.disclaimer {
  font-family: "Arial";
  color: rgb(119,119,119);
  font-weight: 400;
  font-size: 0.850rem;
  font-style: normal;
}

.ss-footer-content {
  font-family: "Arial";
  color: rgb(80,80,80);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

.progress-label {
  font-family: "Roboto";
  color: rgb(140,140,140);
  font-weight: 400;
  font-size: 1.000rem;
  font-style: normal;
}

a:link {
  color: rgb(0,0,238);
}

a:visited {
  color: rgb(85,26,139);
}

a:active {
  color: rgb(252,0,0);
}

input[type='text'], input:not([type]), textarea {
  font-size: 1.000rem;
}

.error, .required, .errorbox-bad {
  border-color: rgb(196,59,29);
}

.jfk-progressBar-nonBlocking .progress-bar-thumb {
  background-color: rgb(140,140,140);
}

.ss-logo-image {
  background-image: url('//ssl.gstatic.com/docs/forms/forms_logo_2_small_dark.png');
  background-size: 108px 21px;
  width: 108px;
  height: 21px;
}

@media screen and (-webkit-device-pixel-ratio: 2) {
.ss-logo-image {
  background-image: url('//ssl.gstatic.com/docs/forms/forms_logo_2_small_dark_2x.png');
}
}

</style>


</head>

<body dir="ltr" class="ss-base-body"><div itemscope="" itemtype="http://schema.org/CreativeWork/FormObject"><meta itemprop="name" content="無限界滑雪行程預定">


<meta itemprop="url" content="https://docs.google.com/forms/d/1-03gpOzsKEKZd_2ZRMhpi0ZafW0roA0J0x6ZIU_IWns/viewform">
<meta itemprop="embedUrl" content="https://docs.google.com/forms/d/1-03gpOzsKEKZd_2ZRMhpi0ZafW0roA0J0x6ZIU_IWns/viewform?embedded=true">
<meta itemprop="faviconUrl" content="https://ssl.gstatic.com/docs/spreadsheets/forms/favicon_qp2.png">




<div class="ss-form-container"><div class="ss-header-image-container"><div class="ss-header-image-image"><div class="ss-header-image-sizer"></div></div></div>


<!--行程預覽區塊-->
<div id="cs_float_itinerary_block" style="background-color: #F5DA81; position: fixed; top: 4em; right: 5em; padding: 1em; border-radius: 5px; box-shadow: 5px 5px 5px #BDBDBD; overflow-y: auto; max-height: 80%;">
    <span style="font-size:26px;"><strong><span>行程費用：</span><span id="cs_price_label" style="color:#FF0000;"> 0 </span>元(NTD/人)    &nbsp;&nbsp;&nbsp;</strong></span>
    <div id="cs_rental_price_block" align="left" style="font-size:15px; display: none;"><strong><span>&nbsp;裝備租用：</span><span id="cs_rental_price_label" > 0 </span>元(NTD/人)</strong></div>
    <div><strong><span style="font-size:10px;">&nbsp;</span></strong></div>
    <div id="cs_itinerary_block"></div>
</div>
<!--行程預覽區塊-->


<div class="ss-form"><form action="https://docs.google.com/forms/d/1-03gpOzsKEKZd_2ZRMhpi0ZafW0roA0J0x6ZIU_IWns/formResponse" method="POST" id="ss-form" target="_self" onsubmit=""><ol role="list" class="ss-question-list" style="padding-left: 0">
    
<div id="cs_page1">
    
<div class="ss-top-of-page"><div class="ss-form-heading" ><h1 class="ss-form-title" dir="ltr" >行程規劃</h1>
</div></div>
    
<div class="ss-form-question errorbox-good" role="listitem">
<div dir="auto" class="ss-item ss-item-required ss-date"><div class="ss-form-entry">
<label class="ss-q-item-label" for="entry_371807638"><div class="ss-q-title">出發日期
<label for="itemView.getDomIdToLabel()" aria-label="（必須）"></label>
<span class="ss-required-asterisk" aria-hidden="true">*</span></div>
<div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
<input type="text" name="entry.371807638" value="12/01/2015" class="" dir="auto" id="entry_371807638" aria-label="航空出發日期  " aria-required="true" required="" >
<div class="required-message">這是必填問題</div></div></div></div> <div class="ss-form-question errorbox-good" role="listitem">
<div dir="auto" class="ss-item ss-item-required ss-radio"><div class="ss-form-entry">
<label class="ss-q-item-label" for="entry_1092768878"><div class="ss-q-title">行程方案
<label for="itemView.getDomIdToLabel()" aria-label="（必須）"></label>
<span class="ss-required-asterisk" aria-hidden="true">*</span></div>
<div class="ss-q-help ss-secondary-text" dir="auto"></div></label>

<ul class="ss-choices" role="radiogroup" aria-label="行程方案  "><li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" checked="true" name="entry.1850683823" value="五天四夜套裝行程" id="group_1850683823_1" role="radio" class="ss-q-radio" aria-label="五天四夜套裝行程" required="" aria-required="true" ></span>
<span class="ss-choice-label">五天四夜套裝行程</span>
</label></li> <li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input  type="radio" name="entry.1850683823" value="六天五夜套裝行程" id="group_1850683823_2" role="radio" class="ss-q-radio" aria-label="六天五夜套裝行程" required="" aria-required="true" ></span>
<span class="ss-choice-label">六天五夜套裝行程</span>
</label></li> <li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" name="entry.1850683823" value="客製行程" id="group_1850683823_3" role="radio" class="ss-q-radio" aria-label="客製行程" required="" aria-required="true" ></span>
<span class="ss-choice-label">客製行程</span>
</label></li> <li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" name="entry.1850683823" value="純滑雪課程" id="group_1850683823_4" role="radio" class="ss-q-radio" aria-label="純滑雪課程" required="" aria-required="true" ></span>
<span class="ss-choice-label">純滑雪課程</span>
</label></li> <li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" name="entry.1850683823" value="住宿加交通" id="group_1850683823_5" role="radio" class="ss-q-radio" aria-label="住宿加交通" required="" aria-required="true" ></span>
<span class="ss-choice-label">住宿加交通</span>
</label></li></ul>
<div class="error-message" id="1092768878_errorMessage"></div>
<div class="required-message">這是必填問題</div></div></div></div>


<div class="ss-form-question errorbox-good" role="listitem">
    <div dir="auto" class="ss-item ss-item-required ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_1132628283"><div class="ss-q-title">報名人數
            <label for="itemView.getDomIdToLabel()" aria-label="(必填欄位)"></label>
            <span class="ss-required-asterisk" aria-hidden="true">*</span>
            <input type="text" name="entry.1132628283" value="1" class="ss-q-short" style="width: 20px" id="entry_1132628283" dir="auto" aria-label="報名人數 6 人以上每人享團體報名優惠 1000 元 " aria-required="true" required="" title="" > 人
        </div>
        <div id="cs_group_special_msg" class="ss-q-help ss-secondary-text" dir="auto">6 人以上每人享團體報名優惠 1000 元</div></label>
        
            <div class="error-message" id="612607187_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>


<div id="cs_singleroom_block" class="ss-form-question errorbox-good" role="listitem">
    <div dir="auto" class="ss-item  ss-radio"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_986182209"><div class="ss-q-title">單人報名選項
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        
        <ul class="ss-choices" role="radiogroup" aria-label="單人報名選項  "><li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" checked="true" name="entry.1572990219" value="安排併房" id="group_1572990219_1" role="radio" class="ss-q-radio" aria-label="安排併房" ></span>
            <span class="ss-choice-label">安排併房</span>
        </label></li> <li class="ss-choice-item"><label><span class="ss-choice-item-control goog-inline-block"><input type="radio" name="entry.1572990219" value="&#25351;&#23450;&#21934;&#20154;&#25151;&nbsp;(+2,500 NTD/day)" id="group_1572990219_2" role="radio" class="ss-q-radio" aria-label="&#25351;&#23450;&#21934;&#20154;&#25151;&nbsp;(+2,500 NTD/day)"></span>
            <span class="ss-choice-label">指定單人房 (+2,500 NTD/day)</span>
        </label></li></ul>
        <div class="error-message" id="986182209_errorMessage"></div>
        <div class="required-message">這是必填問題</div></div></div>
</div>

<!-- This is not original form -->
<div class="ss-form-question errorbox-good" role="listitem">
<div dir="auto" class="ss-item  ss-checkbox"><div class="ss-form-entry">
<label class="ss-q-item-label" for="entry_1175604407"><div class="ss-q-title">滑雪器材租用
</div>
<div class="ss-q-help ss-secondary-text" dir="auto">滑雪用具預先訂購享有九折優惠</div></label>

<table>
    <tr>
        <td><span class="ss-choice-label">全套雪具</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_allgears_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (800元)</td>
    </tr>
    <tr>
        <td><span class="ss-choice-label">全套雪衣</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_allwears_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (800元)</td>
    </tr>
    <tr>
        <td><span class="ss-choice-label">護目鏡，手套</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_goggleglove_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (600元)</td>
    </tr>
    <tr>
        <td><span class="ss-choice-label">護臀，護膝</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_kneepads_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (600元)</td>
    </tr>
    <tr>
        <td><span class="ss-choice-label">護腕，護肘</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_elbowpads_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (600元)</td>
    </tr>
    <tr>
        <td><span class="ss-choice-label">安全帽</span></td>
        <td><input type="text"  value="0" class="ss-q-short" style="width: 20px" id="cs_helmet_text" dir="auto" aria-label="" aria-required="true" required="" title="" > 天 (300元)</td>
    </tr>
</table>


<div class="error-message" id="1175604407_errorMessage"></div>
<div class="required-message">この質問は必須です</div></div></div></div>
<!-- This is not original form -->

<!-- Hidden Fields-->
<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_580752906"><div class="ss-q-title">網站估價
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.580752906" value="" class="ss-q-short" id="entry_580752906" dir="auto" aria-label="網站估價  " title="">
            <div class="error-message" id="240874172_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_34511761"><div class="ss-q-title">回程日期
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.34511761" value="" class="ss-q-short" id="entry_34511761" dir="auto" aria-label="回程日期  " title="">
            <div class="error-message" id="640309022_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_495379638"><div class="ss-q-title">滑雪器材租用
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto">滑雪用具預先訂購享有九折優惠</div></label>
        <input type="text" name="entry.495379638" value="" class="ss-q-short" id="entry_495379638" dir="auto" aria-label="滑雪器材租用 滑雪用具預先訂購享有九折優惠 " title="">
            <div class="error-message" id="1175604407_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_184478099"><div class="ss-q-title">雪場住宿天數
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.184478099" value="" class="ss-q-short" id="entry_184478099" dir="auto" aria-label="雪場住宿天數  " title="">
            <div class="error-message" id="1041473069_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_43940221"><div class="ss-q-title">雪場住宿日期
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.43940221" value="" class="ss-q-short" id="entry_43940221" dir="auto" aria-label="雪場住宿日期  " title="">
            <div class="error-message" id="7040349_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_1230794840"><div class="ss-q-title">東京住宿天數
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.1230794840" value="" class="ss-q-short" id="entry_1230794840" dir="auto" aria-label="東京住宿天數  " title="">
            <div class="error-message" id="160165687_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_1288571416"><div class="ss-q-title">東京住宿日期
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.1288571416" value="" class="ss-q-short" id="entry_1288571416" dir="auto" aria-label="東京住宿日期  " title="">
            <div class="error-message" id="1382663686_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_1054173760"><div class="ss-q-title">滑雪課程
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.1054173760" value="" class="ss-q-short" id="entry_1054173760" dir="auto" aria-label="滑雪課程  " title="">
            <div class="error-message" id="1664194512_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_198043184"><div class="ss-q-title">纜車票
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.198043184" value="" class="ss-q-short" id="entry_198043184" dir="auto" aria-label="纜車票  " title="">
            <div class="error-message" id="1419973398_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_1705104221"><div class="ss-q-title">附註
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.1705104221" value="" class="ss-q-short" id="entry_1705104221" dir="auto" aria-label="附註  " title="">
            <div class="error-message" id="1251050232_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_931324367"><div class="ss-q-title">OrderNo
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.931324367" value="" class="ss-q-short" id="entry_931324367" dir="auto" aria-label="OrderNo  " title="">
            <div class="error-message" id="1172515178_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_87153517"><div class="ss-q-title">RentalPrice
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.87153517" value="" class="ss-q-short" id="entry_87153517" dir="auto" aria-label="RentalPrice  " title="">
            <div class="error-message" id="77914972_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
        <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
            <label class="ss-q-item-label" for="entry_518706610"><div class="ss-q-title">TotalPrice
            </div>
            <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
            <input type="text" name="entry.518706610" value="" class="ss-q-short" id="entry_518706610" dir="auto" aria-label="TotalPrice  " title="">
                <div class="error-message" id="1926213622_errorMessage"></div>
                <div class="required-message">這是必填問題</div>
        </div></div></div>

<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
    <div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_234273720"><div class="ss-q-title">出發日期含星期
        </div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.234273720" value="" class="ss-q-short" id="entry_234273720" dir="auto" aria-label="出發日期含星期  " title="">
            <div class="error-message" id="119001399_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
    </div></div></div>
<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
<div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
    <label class="ss-q-item-label" for="entry_578893294"><div class="ss-q-title">出發日期民國
    </div>
    <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
    <input type="text" name="entry.578893294" value="" class="ss-q-short" id="entry_578893294" dir="auto" aria-label="出發日期民國  " title="">
        <div class="error-message" id="439314675_errorMessage"></div>
        <div class="required-message">這是必填問題</div>
</div></div></div>
<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
<div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
<label class="ss-q-item-label" for="entry_1432250747"><div class="ss-q-title">總天數
</div>
<div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
<input type="text" name="entry.1432250747" value="" class="ss-q-short" id="entry_1432250747" dir="auto" aria-label="總天數  " title="">
    <div class="error-message" id="1499732166_errorMessage"></div>
    <div class="required-message">這是必填問題</div>
</div></div></div>
<div class="ss-form-question errorbox-good" style="display: none;" role="listitem">
<div dir="auto" class="ss-item  ss-text"><div class="ss-form-entry">
    <label class="ss-q-item-label" for="entry_2016721542"><div class="ss-q-title">合約內容變動部分
    </div>
    <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
    <input type="text" name="entry.2016721542" value="" class="ss-q-short" id="entry_2016721542" dir="auto" aria-label="合約內容變動部分  " title="">
        <div class="error-message" id="2082912956_errorMessage"></div>
        <div class="required-message">這是必填問題</div>
</div></div></div>
<!-- Hidden Fields -->

<input id="cs_page1_button" type="button" value="我要預定此行程" class="jfk-button jfk-button-action "></input>
</div><!--end of page1-->

<div id="cs_page2" style="display: none">

<div class="ss-top-of-page"><div class="ss-form-heading" ><h1 class="ss-form-title" dir="ltr" >填寫基本資料</h1>
</div></div>
<!-- Customer Data -->
<div class="ss-form-question errorbox-good" role="listitem">
    <div dir="auto" class="ss-item ss-item-required ss-text"><div class="ss-form-entry">
        <label class="ss-q-item-label" for="entry_162334559"><div class="ss-q-title">姓名
            <label for="itemView.getDomIdToLabel()" aria-label="(必填欄位)"></label>
            <span class="ss-required-asterisk" aria-hidden="true">*</span></div>
        <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
        <input type="text" name="entry.162334559" value="" class="ss-q-short" id="entry_162334559" dir="auto" aria-label="姓名  " aria-required="true" required="" title="">
            <div class="error-message" id="1777787422_errorMessage"></div>
            <div class="required-message">這是必填問題</div>
</div></div></div>

<div class="ss-form-question errorbox-good" role="listitem">
        <div dir="auto" class="ss-item ss-item-required ss-text"><div class="ss-form-entry">
            <label class="ss-q-item-label" for="entry_1282595368"><div class="ss-q-title">Email
                <label for="itemView.getDomIdToLabel()" aria-label="(必填欄位)"></label>
                <span class="ss-required-asterisk" aria-hidden="true">*</span></div>
            <div class="ss-q-help ss-secondary-text" dir="auto"></div></label>
            <input type="text" name="entry.1282595368" value="" class="ss-q-short" id="entry_1282595368" dir="auto" aria-label="Email  " aria-required="true" required="" title="">
                <div class="error-message" id="1492951065_errorMessage">必填</div>
                <div class="required-message">這是必填問題</div>
</div></div></div>
<!-- Customer Data -->
<input id="cs_page2_back_button" type="button" value="回行程規劃" class="jfk-button jfk-button-action "></input>
<input id="cs_page2_button" type="button" value="下一步" class="jfk-button jfk-button-action "></input>

</div><!--end of page2-->



<input type="hidden" name="draftResponse" value="[,,&quot;-704274614675909186&quot;]
">
<input type="hidden" name="pageHistory" value="0">

<input type="hidden" name="fvv" value="0">


<input type="hidden" name="fbzx" value="-704274614675909186">
    
<div id="cs_page3" style="display: none">

<div class="ss-top-of-page"><div class="ss-form-heading" ><h1 class="ss-form-title" dir="ltr" >訂單確認</h1>
</div></div>

<div id="cs_order_content"></div>

<div class="ss-item ss-navigate"><table id="navigation-table"><tbody><tr><td class="ss-form-entry goog-inline-block" id="navigation-buttons" dir="ltr">
<input id="cs_page3_back_button" type="button" value="回基本資料" class="jfk-button jfk-button-action "></input>
<input type="submit" name="submit" value="送出訂單" id="ss-submit" class="jfk-button jfk-button-action ">
</td>
</tr></tbody></table></div>

</div><!--end of page3-->
</ol></form></div>
<div class="ss-footer"><div class="ss-attribution"></div>
</div></div>

<script type="text/javascript">
    /****** 新建表單步驟*******/
    // 1. 將此 script 區塊貼到新表單 form element 後面
    // 2. 表頭加入以下三個 javascript 元件
    //  link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/eggplant/jquery-ui.css"
    //  script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"
    //  script src="https://code.jquery.com/ui/1.11.3/jquery-ui.min.js"
    // 3. 將 html element id 配對至 javascript element, 參照 UI Elements 區塊
    // 4. 加入 cs_price_label, cs_itinerary_block 的 Html Code
    // 5. 針對 cs_singleroom_block, cs_group_special_msg 建立 html 區塊 element, 條件隱藏會用到
    // 6. 必要的資源檔為 base.csv
    /****** 新建表單步驟 ******/
    
    /****** Global Properties ******/
    var _rate = 0.275;
    var _itinerary = new Itinerary();
    var _factory = new Factory();
    var _basePriceList = 0;
    
    /****** 調整價格表 Constants ******/
    var cs_adjust_no_flight = 6000; //退機票
    var cs_bus_base_price = 3600; // 巴士 3100, 手續費 500
    var cs_adjust_one_way_bus = 1300; // 單程巴士退 1300
    var cs_adjust_flight_modify_fee = 3000; // 超過 6 天收取改機票手續費
    var cs_adjust_no_ticket = 1000; //退雪票
    var cs_adjust_no_tokyo = 1500;  //退東京
    var cs_adjust_no_coach = 2000;  //退教練
    var cs_adjust_single_room = 2500;  //單人房
    var cs_adjust_group_special = 1000;  //團體優惠
    var cs_adjust_ticket = 4200;  //雪票一天 JPY
    var cs_specific_instructor = 5000;  //指定教練 JPY
    var cs_2hr_group_class = 1400;  //2hr團體課
    var cs_2hr_private_class = 7200;  //2h私人課
    var cs_4hr_group_class = 2500;  //一天團體課
    var cs_4hr_private_class = 14000;  //一天私人課
    var cs_one_more_private_class = 2000;  //私人課追加一人 JPY
    
    /****** UI Elements ******/
    var cs_setoff_date_ele = document.getElementById("entry_371807638");
    var cs_itinerary_5days_radio_ele = document.getElementById("group_1850683823_1");
    var cs_itinerary_6days_radio_ele = document.getElementById("group_1850683823_2");
    var cs_itinerary_custom_radio_ele = document.getElementById("group_1850683823_3");
    var cs_itinerary_class_only_radio_ele = document.getElementById("group_1850683823_4");
    var cs_itinerary_noski_radio_ele = document.getElementById("group_1850683823_5");
    var cs_people_text_ele = document.getElementById("entry_1132628283");
    var cs_shareroom_radio_ele = document.getElementById("group_1572990219_1");
    var cs_singleroom_radio_ele = document.getElementById("group_1572990219_2");
    var cs_allgears_text_ele = document.getElementById("cs_allgears_text");
    var cs_allwears_text_ele = document.getElementById("cs_allwears_text");
    var cs_goggleglove_text_ele = document.getElementById("cs_goggleglove_text");
    var cs_kneepads_text_ele = document.getElementById("cs_kneepads_text");
    var cs_elbowpads_text_ele = document.getElementById("cs_elbowpads_text");
    var cs_helmet_text_ele = document.getElementById("cs_helmet_text");
    
    /****** UI Elements(Hidden) ******/
    var cs_offer_field_ele = document.getElementById("entry_580752906");
    var cs_return_date_field_ele = document.getElementById("entry_34511761");
    var cs_rental_field_ele = document.getElementById("entry_495379638");
    var cs_ski_resort_days_field_ele = document.getElementById("entry_184478099");
    var cs_ski_resort_date_field_ele = document.getElementById("entry_43940221");
    var cs_tokyo_days_field_ele = document.getElementById("entry_1230794840");
    var cs_tokyo_date_field_ele = document.getElementById("entry_1288571416");
    var cs_class_field_ele = document.getElementById("entry_1054173760");
    var cs_lift_ticket_field_ele = document.getElementById("entry_198043184");
    var cs_misc_field_ele = document.getElementById("entry_1705104221");
    var cs_orderno_field_ele = document.getElementById("entry_931324367");
    var cs_rental_price_field_ele = document.getElementById("entry_87153517");
    var cs_total_price_field_ele = document.getElementById("entry_518706610");
    var cs_total_days_field_ele = document.getElementById("entry_1432250747");
    var cs_setoff_date_week_ele = document.getElementById("entry_234273720");
    var cs_setoff_date_taiwan_ele = document.getElementById("entry_578893294");
    var cs_contract_ele = document.getElementById("entry_2016721542");
    
    /****** Block Elements ******/
    var cs_singleroom_block_ele = document.getElementById("cs_singleroom_block");
    var cs_group_special_msg_ele = document.getElementById("cs_group_special_msg");
    
    
    /****** Display Elements ******/
    var cs_price_label_ele = document.getElementById("cs_price_label");
    var cs_rental_price_label_ele = document.getElementById("cs_rental_price_label");
    var cs_rental_price_block_ele = document.getElementById("cs_rental_price_block");
    var cs_itinerary_block_ele = document.getElementById("cs_itinerary_block");
    
    /****** Page Elements ******/
    var cs_page1_ele = document.getElementById("cs_page1");
    var cs_page2_ele = document.getElementById("cs_page2");
    var cs_page3_ele = document.getElementById("cs_page3");
    var cs_page1_button_ele = document.getElementById("cs_page1_button");
    var cs_page2_button_ele = document.getElementById("cs_page2_button");
    var cs_page2_back_button_ele = document.getElementById("cs_page2_back_button");
    var cs_page3_back_button_ele = document.getElementById("cs_page3_back_button");
    var cs_float_itinerary_block_ele = document.getElementById("cs_float_itinerary_block");
    var cs_order_content_ele = document.getElementById("cs_order_content");
    
    
    /****** Init Scripts ******/
    function bindEventHandlers() {
        cs_setoff_date_ele.onchange = setOffDateChanged;
        cs_itinerary_5days_radio_ele.onclick = fiveDaysRadioButtonOnClick;
        cs_itinerary_6days_radio_ele.onclick = sixDaysRadioButtonOnClick;
        cs_itinerary_custom_radio_ele.onclick = customRadioButtonOnClick;
        cs_itinerary_class_only_radio_ele.onclick = classOnlyRadioButtonOnClick;
        cs_itinerary_noski_radio_ele.onclick = bedAndBusRadioButtonOnClick;
        cs_people_text_ele.oninput = peopleTextFieldOnInput;
        cs_shareroom_radio_ele.onclick = shareRoomRadioButtonOnClick;
        cs_singleroom_radio_ele.onclick = singleRoomRadioButtonOnClick;
        cs_allgears_text_ele.oninput = allGearTextFieldOnInput;
        cs_allwears_text_ele.oninput = allWearTextFieldOnInput;
        cs_goggleglove_text_ele.oninput = goggleGloveTextFieldOnInput;
        cs_kneepads_text_ele.oninput = kneePadsTextFieldOnInput;
        cs_elbowpads_text_ele.oninput = elbowPadsTextFieldOnInput;
        cs_helmet_text_ele.oninput = helmetTextFieldOnInput;
        cs_page1_button_ele.onclick = page1ButtonOnClick;
        cs_page2_button_ele.onclick = page2ButtonOnClick;
        cs_page2_back_button_ele.onclick = page2BackButtonOnClick;
        cs_page3_back_button_ele.onclick = page3BackButtonOnClick;
    }

    function pageInit() {
        // Load the datepicker module to date fields
        $(function() {
          $( cs_setoff_date_ele ).datepicker();
        });
        
        bindEventHandlers();
        
        //Load base prices and show a default itinerary after that.
        loadCsvData("./base.csv", fiveDaysRadioButtonOnClick);
    }

    pageInit();

    /****** Display Control Functions(Only effect the UIs) ******/
    function hideAllBlock() {
        cs_group_special_msg_ele.style.display = "none";
        cs_singleroom_block_ele.style.display = "none";
    }

    function resetFields() {
        cs_people_text_ele.value = 1;
        cs_shareroom_radio_ele.checked = true;
        cs_allgears_text_ele.value = 0;
        cs_allwears_text_ele.value = 0;
        cs_goggleglove_text_ele.value = 0;
        cs_kneepads_text_ele.value = 0;
        cs_elbowpads_text_ele.value = 0;
        cs_helmet_text_ele.value = 0;
    }

    function showGourpBlock() {
        cs_singleroom_block_ele.style.display = "block";
        cs_group_special_msg_ele.style.display = "block";
    }

    function showCustomOptions() {
        cs_singleroom_block_ele.style.display = "block";
    }

    /****** Record to Spreadsheet Functions *******/
    function setValueToHiddenFields() {
        cs_offer_field_ele.value = _itinerary.offer;
        cs_setoff_date_ele.value = _itinerary.dates[0].date.simpleString();
        cs_return_date_field_ele.value = _itinerary.returnDate.simpleString();
        cs_rental_field_ele.value = _itinerary.gear.getDescription();
        cs_ski_resort_days_field_ele.value = _itinerary.totalResortDays();
        cs_ski_resort_date_field_ele.value = _itinerary.getResortDateDescription();
        cs_tokyo_days_field_ele.value = _itinerary.totalTokyoDays();
        cs_tokyo_date_field_ele.value = _itinerary.getTokyoDateDescription();
        cs_class_field_ele.value = _itinerary.getClassDescription();
        cs_lift_ticket_field_ele.value = _itinerary.getLiftTicketDescription();
        cs_misc_field_ele.value = _itinerary.getMiscDescription();
        cs_orderno_field_ele.value = _itinerary.getOrderNoPrefix();
        var rentalPrice = _itinerary.gear.calPrice();
        cs_rental_price_field_ele.value = rentalPrice;
        cs_total_price_field_ele.value = _itinerary.offer+rentalPrice;
        //cs_people_text_ele.value = _itinerary.numberOfCustomer
        cs_total_days_field_ele.value = _itinerary.dates.length+1;
        cs_setoff_date_week_ele.value = _itinerary.dates[0].date.simpleStringWithWeek();
        cs_setoff_date_taiwan_ele.value = _itinerary.dates[0].date.formatTaiwan();
        cs_contract_ele.value = _itinerary.getContractText();
    }

    /****** UI Event Handler ******/
    function setOffDateChanged() {
        var setOffDate = cs_setoff_date_ele.value;
        if(!_itinerary.changeDate(setOffDate)) {
            cs_setoff_date_ele.value = _itinerary.dayOneDate().mmddyyyy();
            alert("出發日 " + setOffDate + " 無法訂購。");
            return;
        }
        
        updateAll();
    }

    function fiveDaysRadioButtonOnClick() {
        hideAllBlock();
        resetFields();
        showGourpBlock();
        
        var setOffDate = cs_setoff_date_ele.value;
        _itinerary = _factory.createItineraryWithBasic5Days(setOffDate);
        
        updateAll();
    }

    function sixDaysRadioButtonOnClick() {
        hideAllBlock();
        resetFields();
        showGourpBlock();
        
        var setOffDate = cs_setoff_date_ele.value;
        _itinerary = _factory.createItineraryWithBasic6Days(setOffDate);
        
        updateAll();
    }

    function customRadioButtonOnClick() {
        hideAllBlock();
        resetFields();
        showCustomOptions();
        
        var setOffDate = cs_setoff_date_ele.value;
        _itinerary = _factory.createItineraryWithBasic5Days(setOffDate);
        _itinerary.type = 2;
        
        updateAll();
    }

    function classOnlyRadioButtonOnClick() {
        hideAllBlock();
        resetFields();
        
        
        var setOffDate = cs_setoff_date_ele.value;
        _itinerary = _factory.createItineraryWithClassOnly(setOffDate);
        updateAll();
    }

    function bedAndBusRadioButtonOnClick() {
        hideAllBlock();
        resetFields();
        showCustomOptions();
        
        var setOffDate = cs_setoff_date_ele.value;
        _itinerary = _factory.createItineraryWithBedAndBus(setOffDate);
        updateAll();
    }

    function peopleTextFieldOnInput() {
        if(cs_people_text_ele.value == 1 && !cs_itinerary_class_only_radio_ele.checked) {
            cs_singleroom_block_ele.style.display = "block";
        } else {
            cs_singleroom_block_ele.style.display = "none";
            cs_shareroom_radio_ele.checked = true;
            _itinerary.singleRoom = false;
        }
        
        _itinerary.numberOfCustomer = cs_people_text_ele.value;
        updatePrice();
    }

    function shareRoomRadioButtonOnClick() {
        _itinerary.singleRoom = false;
        updatePrice();
    }

    function singleRoomRadioButtonOnClick() {
        _itinerary.singleRoom = true;
        updatePrice();
    }

    function allGearTextFieldOnInput() {
        var rentTimes = cs_allgears_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }

        _itinerary.gear.allgear = parseInt(rentTimes);
        updatePrice();
    }

    function allWearTextFieldOnInput() {
        var rentTimes = cs_allwears_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }
        
        _itinerary.gear.allwear = parseInt(rentTimes);
        updatePrice();
    }

    function goggleGloveTextFieldOnInput() {
        var rentTimes = cs_goggleglove_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }
        
        _itinerary.gear.goggleGlove = parseInt(rentTimes);
        updatePrice();
    }

    function kneePadsTextFieldOnInput() {
        var rentTimes = cs_kneepads_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }
        
        _itinerary.gear.kneePads = parseInt(rentTimes);
        updatePrice();
    }

    function elbowPadsTextFieldOnInput() {
        var rentTimes = cs_elbowpads_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }
        
        _itinerary.gear.elbowPads = parseInt(rentTimes);
        updatePrice();
    }

    function helmetTextFieldOnInput() {
        var rentTimes = cs_helmet_text_ele.value;
        if(rentTimes < 0 || rentTimes=="") {
            return;
        }
        
        _itinerary.gear.helmet = parseInt(rentTimes);
        updatePrice();
    }

    function addOneDayButtonOnClick() {
        _itinerary.addItineraryItem();
        updateAll();
    }

    function removeOneDayButtonOnClick() {
        _itinerary.removeItineraryItem();
        updateAll();
    }

    function cancelTokyoButtonOnClick() {
      _itinerary.cancelTokyo();
      updateAll();
    }

    function cancelLiftTicketButtonOnClick() {
        _itinerary.cancelLiftTicket();
        updateAll();
    }

    function cancelGroupClassButtonOnClick() {
        _itinerary.cancelGroupClass();
        updateAll();
    }

    function cancelFlightCheckBoxOnClick() {
        _itinerary.flight = !this.checked;
        updatePrice();
    }

    function goWayBusCancelOnClick() {
        _itinerary.goWayBus = false;
        updateAll();
    }

    function returnWayBusCancelOnClick() {
        _itinerary.returnWayBus = false;
        updateAll();
    }

    function resetBusOnClick() {
        
    }

    function page1ButtonOnClick() {
        cs_page1.style.display = "none";
        cs_page2.style.display = "block";
        cs_float_itinerary_block_ele.style.display = "none";
    }

    function page2ButtonOnClick() {
        cs_page2.style.display = "none";
        cs_page3.style.display = "block";
    }

    function page2BackButtonOnClick() {
        cs_page1.style.display = "block";
        cs_page2.style.display = "none";
        cs_float_itinerary_block_ele.style.display = "block";
    }

    function page3BackButtonOnClick() {
        cs_page2.style.display = "block";
        cs_page3.style.display = "none";
    }

    /****** Itinerary Class Definition ******/
    function Itinerary() {
        // Properties
        this.type = 0; // 0: 5days, 1: 6days, 2: custom, 3: class only, 4: bed and bus
        this.dates = [];
        this.returnDate = null; // 回程日期
        this.price = 0; // base price
        this.offer = 0; // final price
        this.numberOfCustomer = 1; // 報名人數
        this.flight = true; // 是否訂購機票
        this.goWayBus = true; // 巴士去程（住宿加交通行程限定）
        this.returnWayBus = true; // 巴士回程
        this.singleRoom = false;
        this.gear = new GearRental();
        
        this.changeDate = function(firstDateStr) {
            var firstDate = new Date(firstDateStr);
            var basePrice = searchDate(firstDate.simpleString(), _basePriceList);
            
            if(!basePrice) {
                return false; //回傳 null, 如果該天團費找不到
            }
            
            if(this.type == 0 || this.type == 2) {
                this.price = basePrice[1];
            }else if(this.type == 1){
                this.price = basePrice[2];
            }else if(this.type == 3){
                this.price = 0;
            }if(this.type == 4){
                this.price = cs_bus_base_price;
            }
            
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                itineraryItem.date = firstDate.addDays(i);
            }
            
            this.returnDate = firstDate.addDays(this.dates.length);
            
            return true;
        }
        
        this.dayOneDate = function() {
            return this.dates[0].date;
        }
        
        this.addItineraryItem = function() {
            var newDate = this.returnDate;
            var defaultAcc = 0;
            if(this.type == 4) {
                defaultAcc = 1;
            }
            var newItem = _factory.createItineraryItem(newDate, defaultAcc, false, 0, 0);
            this.dates.push(newItem);
            this.returnDate = newDate.addDays(1);
            return newItem;
        }
        
        this.removeItineraryItem = function() {
            this.returnDate = this.dates.pop().date;
        }
        
        this.cancelLiftTicket = function() {
            this.dates[0].adjustPrice = this.dates[0].adjustPrice - cs_adjust_no_ticket;
            this.dates[1].liftTicket = false;
            this.dates[2].liftTicket = false;
        }

        this.cancelGroupClass = function() {
             this.dates[0].adjustPrice = this.dates[0].adjustPrice - cs_adjust_no_coach;
             this.dates[1].skiClass = 0;
             this.dates[2].skiClass = 0;
        }
        
        this.cancelTokyo = function() {
            this.dates[0].adjustPrice = this.dates[0].adjustPrice - cs_adjust_no_tokyo;
            this.dates[3].accommodation = 0;
        }
        
        this.calPrice = function() {
            var finalPrice = parseInt(this.price);

            // 6人以上優惠
            if(this.type < 2 && this.numberOfCustomer > 5) {
                finalPrice = finalPrice - cs_adjust_group_special;
            }
            
            // 退機票
            if(!this.flight && this.type < 3) {
                finalPrice = finalPrice - cs_adjust_no_flight;
            }else if(this.flight && this.dates.length > 5) { // 超過 6 天加收改機票手續費
                finalPrice = finalPrice + cs_adjust_flight_modify_fee;
            }
            
            // 單程巴士(交通加住宿)
            if(!(this.goWayBus && this.returnWayBus)) {
                finalPrice = finalPrice - cs_adjust_one_way_bus;
            }
            
            var groupBaseDay = 100; // 小於這個數字天數將不會額外計算

            if(this.type == 4) {
                groupBaseDay = 0;
            }else if(this.type == 2) {
                groupBaseDay = 3;
            }
            
            // 每天調整價格
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                finalPrice = finalPrice + itineraryItem.calPrice(i < groupBaseDay);
                
                // 指定單人房
                if(itineraryItem.accommodation > 0 && this.singleRoom && this.numberOfCustomer == 1) {
                    finalPrice += cs_adjust_single_room;
                }
            }
            if(this.type != 3) {
                finalPrice = priceFinetune(finalPrice);
            }
            
            this.offer = finalPrice;
            
            return finalPrice;
        }
        
        this.totalResortDays = function() {
            var days = 0;
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                if(itineraryItem.accommodation == 1) {
                    days++;
                }
            }
            return days;
        };
        
        this.getResortDateDescription = function() {
            var text = "";
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                if(itineraryItem.accommodation == 1) {
                    text += itineraryItem.date.simpleString() + ", ";
                }
            }
            return text;
        };
        
        this.totalTokyoDays = function() {
            var days = 0;
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                if(itineraryItem.accommodation > 1) {
                    days++;
                }
            }
            return days;
        };
        
        this.getTokyoDateDescription = function() {
            var text = "";
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                if(itineraryItem.accommodation > 1) {
                    text += itineraryItem.date.simpleString() + ", ";
                }
            }
            return text;
        };
        
        this.getClassDescription = function() {
            var text = "";
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                // 0: None, 1: G2hr, 2: G4hr, 3: P2hr, 4: P3hr, 5: P4hr, 6: Default
                if(itineraryItem.skiClass == 2 || itineraryItem.skiClass == 6) {
                    text += itineraryItem.date.simpleString() + " 團體課程 4 小時, ";
                }else if(itineraryItem.skiClass == 1) {
                    text += itineraryItem.date.simpleString() + " 團體課程 2 小時, ";
                }else if(itineraryItem.skiClass > 2) {
                    text += itineraryItem.date.simpleString() + " 私人課程 "+(itineraryItem.skiClass-1)+" 小時, ";
                }
            }
            return text;
        };
        
        this.getLiftTicketDescription = function() {
            var tickets = 0;
            for(var i = 0; i < this.dates.length; i++) {
                itineraryItem = this.dates[i];
                if(itineraryItem.liftTicket) {
                    tickets++;
                }
            }
            return tickets;
        };
        
        this.getMiscDescription = function() {
            var text = "";
            
            var roomTypeText = "安排併房";
            if(this.singleRoom) {
                roomTypeText = "指定單人房";
            }
            
            if(this.type != 3 && this.numberOfCustomer == 1) {
                text += roomTypeText + ", ";
            }
            
            if(!this.flight && this.type < 3) {
                text += "退機票, ";
            }
            
            if(this.goWayBus) {
                text += "去程巴士, ";
            }
            
            if(this.returnWayBus) {
                text += "回程巴士";
            }
            
            return text;
        };
        
        this.getOrderNoPrefix = function() {
            text = "";
            if(this.type < 2) {
                text += "A";
            }else if(this.type == 2){
                text += "B";
            }else if(this.type == 3){
                text += "D";
            }else if(this.type == 4){
                text += "C";
            }
            
            var today = new Date();
            var yearL2 = today.getFullYear() - 2000;
            var month = ""+(today.getMonth()+1);
            
            text += (yearL2+month);
            text += "ca";

            return text;
            
        }
        
        this.getContractText = function() {
            var text = "";
            if(this.type == 0) {
                text = "二、【費用包含】桃園／東京／桃園，來回團體經濟艙機票乙張。《限團去團回》"+
                
                "成田機場至白馬滑雪場接機費用及白馬滑雪場至東京市區飯店接送服務。專屬中文國際滑雪教練2日教學費用" +
                
                "特別加贈白馬岩岳滑雪場地2日劵。               " +
                
                "三、【單人房選購費用】本行程需兩兩成行報名，若為單人報名，指定單人房，需補收單人住宿房差，全程每位NTD10,000。" +
            
                "                                                                                            " +
                "                                                                                            " +
                
                "四、【滑雪用具選購費用】雪衣、雪褲、全套雪具、護目鏡、手套，每天租借費用3000台幣。"+
                "                                            " +
                
                "五、前項協議事項，如有變更本契約其他條款之規定，除經交通部觀光局核准，其約定無效，但有利於甲方者，不在此限。";
                
            }else if(this.type == 1) {
                text = "二、【費用包含】桃園／東京／桃園，來回團體經濟艙機票乙張。《限團去團回》" +
                
                "成田機場至白馬滑雪場接機費用及白馬滑雪場至東京市區飯店接送服務。專屬中文國際滑雪教練2日教學費用" +
                
                "特別加贈白馬岩岳滑雪場地3日劵。               " +
                
                "三、【單人房選購費用】本行程需兩兩成行報名，若為單人報名，指定單人房，需補收單人住宿房差，全程每位NTD10,000。" +
                
                "                                                                                            " +
                "                                                                                            " +
                
                "四、【滑雪用具選購費用】雪衣、雪褲、全套雪具、護目鏡、手套，每天租借費用3000台幣。" +
                "                                            " +
                
                "五、前項協議事項，如有變更本契約其他條款之規定，除經交通部觀光局核准，其約定無效，但有利於甲方者，不在此限。";
                
            }else{
                text = "二、前項協議事項，如有變更本契約其他條款之規定，除經交通部觀光局核准，其約定無效，但有利於甲方者，不在此限。";
            }
            
            return text;
        }
        
        // Tool functions
        Date.prototype.addDays = function(days)
        {
            var dat = new Date(this.valueOf());
            dat.setDate(dat.getDate() + days);
            return dat;
        }
    }

    function GearRental() {
        // Properties
        this.allgear = 0;
        this.allwear = 0;
        this.goggleGlove = 0;
        this.kneePads = 0;
        this.elbowPads = 0;
        this.helmet = 0;
        
        // Constants
        this.priceOff = 0.9;
        this.allgear_price = 800;  //全套裝備
        this.allwear_price = 800;  //全套雪衣
        this.goggleglove_price = 600;  //Goggle 手套
        this.kneepad_price = 600;  //護膝
        this.elbowpad_price = 600;  //護肘
        this.helmet_price = 300;  //安全帽
        
        this.calPrice = function() {
            var price = 0;
            
            price += this.allgear * this.allgear_price * this.priceOff;
            price += this.allwear * this.allwear_price * this.priceOff;
            price += this.goggleGlove * this.goggleglove_price * this.priceOff;
            price += this.kneePads * this.kneepad_price * this.priceOff;
            price += this.elbowPads * this.elbowpad_price * this.priceOff;
            price += this.helmet * this.helmet_price * this.priceOff;

            return price;
        }
        
        this.getDescription = function() {
            var text = "";
            if(this.allgear > 0) {
                text += "全套雪具 x" + this.allgear + ", ";
            }
            
            if(this.allwear > 0) {
                text += "全套雪衣 x" + this.allwear + ", ";
            }
            
            if(this.goggleGlove > 0) {
                text += "Goggle手套 x" + this.goggleGlove + ", ";
            }
            
            if(this.kneePads > 0) {
                text += "護臀護膝 x" + this.kneePads + ", ";
            }
            
            if(this.elbowPads > 0) {
                text += "護腕護肘 x" + this.elbowPads + ", ";
            }
            
            if(this.helmet > 0) {
                text += "安全帽 x" + this.helmet + ", ";
            }
            
            return text;
        }
    }

    /****** ItineraryItem Class Definition ******/
    function ItineraryItem(date) {
        // Properties
        this.date = date;
        this.adjustPrice = 0;
        this.accommodation = 0; // 0: None, 1: SkiResort, 2: Tokyo, 3: Tokyo(Default)
        this.liftTicket = false;
        this.skiClass = 0; // 0: None, 1: G2hr, 2: G4hr, 3: P2hr, 4: P3hr, 5: P4hr, 6: Default
        
        this.calPrice = function(skip) {
            var price = 0;
            if(!skip) { // 基本行程前幾天不用額外算
                var basePrice = searchDate(this.date.simpleString(), _basePriceList);
                
                if(this.accommodation == 1) { // Ski Resort
                    price += parseInt(basePrice[3])*_rate;
                } else if(this.accommodation == 2) { // Tokyo
                    price += parseInt(basePrice[4])*_rate;
                }
                
                if(this.liftTicket) { // 是否雪票
                    price += cs_adjust_ticket*_rate;
                }
                
            }
            
            if(this.skiClass == 1) {
                price += cs_2hr_group_class;
            }else if(this.skiClass == 2) {
                price += cs_4hr_group_class;
            }else if(this.skiClass > 2 && this.skiClass < 5) {
                price += cs_2hr_private_class/2*(this.skiClass-1);
            }else if(this.skiClass == 5) {
                price += cs_4hr_private_class;
            }
            
            return this.adjustPrice + price;
        }
        
    }

    /****** Factory Functions *******/
    function Factory() {
        this.createItineraryWithBasic5Days = function(firstDateStr) {
            var instance = new Itinerary();
            instance.type = 0;
            instance.numberOfCustomer = 1;
            
            //從價格表中搜尋基本團費
            var firstDate = new Date(firstDateStr);
            
            var basePrice = searchDate(firstDate.simpleString(), _basePriceList);
            
            if(!basePrice) {
                return null; //回傳 null, 如果該天團費找不到
            }else{
                instance.price = basePrice[1];
            }
            
            instance.dates.push(this.createItineraryItem(firstDate, 1, false, 0));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(1), 1, true, 6));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(2), 1, true, 6));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(3), 3, false, 0));
            
            instance.returnDate = firstDate.addDays(4);
            return instance;
        };

        this.createItineraryWithBasic6Days = function(firstDateStr) {
            var instance = new Itinerary();
            instance.type = 1;
            instance.numberOfCustomer = 1;
            
            //從價格表中搜尋基本團費
            var firstDate = new Date(firstDateStr);
            var basePrice = searchDate(firstDate.simpleString(), _basePriceList);
            if(!basePrice) {
                return null; //回傳 false, 如果該天團費找不到
            }else{
                instance.price = basePrice[2];
            }
            
            instance.dates.push(this.createItineraryItem(firstDate, 1, false, 0));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(1), 1, true, 6));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(2), 1, true, 6));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(3), 1, true, 0));
            instance.dates.push(this.createItineraryItem(firstDate.addDays(4), 3, false, 0));
            
            instance.returnDate = firstDate.addDays(5);
            return instance;
        };
        
        this.createItineraryWithClassOnly = function(firstDateStr) {
            var instance = new Itinerary();
            instance.type = 3;
            instance.numberOfCustomer = 1;
            instance.flight = false;
            instance.goWayBus = false;
            instance.returnWayBus = false;
            
            //從價格表中搜尋基本團費
            var firstDate = new Date(firstDateStr);
            var basePrice = searchDate(firstDate.simpleString(), _basePriceList);
            if(!basePrice) {
                return null; //回傳 false, 如果該天團費找不到
            }else{
                instance.price = 0;
            }
            
            instance.dates.push(this.createItineraryItem(firstDate, 0, false, 2));
            
            instance.returnDate = firstDate.addDays(1);
            return instance;
        };
        
        this.createItineraryWithBedAndBus = function(firstDateStr) {
            var instance = new Itinerary();
            instance.type = 4;
            instance.numberOfCustomer = 1;
            instance.flight = false;
            
            //從價格表中搜尋基本團費
            var firstDate = new Date(firstDateStr);
            var basePrice = searchDate(firstDate.simpleString(), _basePriceList);
            if(!basePrice) {
                return null; //回傳 false, 如果該天團費找不到
            }else{
                instance.price = cs_bus_base_price;
            }
            
            instance.dates.push(this.createItineraryItem(firstDate, 1, false, 0));
            
            instance.returnDate = firstDate.addDays(1);
            return instance;
        };
        
        this.createItineraryItem = function(date, accommodation, lift_ticket, ski_class) {
            var day = new ItineraryItem(date);
            day.accommodation = accommodation;
            day.liftTicket = lift_ticket;
            day.skiClass = ski_class;
            return day;
        };
        
        // Date to format YYYY/MM/dd
        Date.prototype.simpleString = function()
        {
            return this.getFullYear() + "/" + (this.getMonth()+1) + "/" + this.getDate();
        }
    }

    /****** Visualized Methods (Model to UI)*******/

    function updateAll() {
        updatePrice();
        updateItinerary();
    }

    function updatePrice() {
        if(!_itinerary) {
            return;
        }
        var price = _itinerary.calPrice();
        //if(_itinerary.type!=3) {
        //    price = priceFinetune(price);
        //}
        // update hidden forms
        setValueToHiddenFields();
        // update page3
        showOrderContent();
        // show price on the label
        showPrice(price);
        showRentalPrice(_itinerary.gear.calPrice());
    }

    function updateItinerary() {
        showItinerary();
    }


    // Show price on the label above the itinerary
    function showPrice(price) {
        cs_price_label_ele.innerHTML = price;
    }

    // Show price on the label above the itinerary
    function showRentalPrice(price) {
        if(price > 0) {
            cs_rental_price_label_ele.innerHTML = price;
            cs_rental_price_block_ele.style.display = "block";
        }else{
            cs_rental_price_block_ele.style.display = "none";
        }
    }

    // Draw the whole Itinerary
    function showItinerary() {
        if(!_itinerary) {
            return;
        }
        // reset the content
        cs_itinerary_block_ele.innerHTML = "";
     
        if(_itinerary.type == 2) {
            cs_itinerary_block_ele.appendChild(getEditableItineraryDiv());
        }else if(_itinerary.type == 3){
            cs_itinerary_block_ele.appendChild(getEditableClassOnlyItineraryDiv());
        }else if(_itinerary.type == 4){
            cs_itinerary_block_ele.appendChild(getEditableBedAndBusItineraryDiv());
        }else{
            cs_itinerary_block_ele.appendChild(getPlainItineraryDiv());
        }
    }

    function showOrderContent() {
        // reset page3
        cs_order_content_ele.innerHTML = "";
        
        var typeText = "";
        if(_itinerary.type == 0) {
            typeText = "五天四夜套裝行程";
        }else if(_itinerary.type == 1) {
            typeText = "六天五夜套裝行程";
        }else if(_itinerary.type == 2) {
            typeText = "客製行程";
        }else if(_itinerary.type == 3) {
            typeText = "純滑雪行程";
        }else if(_itinerary.type == 4) {
            typeText = "住宿加交通";
        }
        var typeDiv = document.createElement("div");
        typeDiv.appendChild(document.createTextNode("方案："+typeText));
        
        var peopleDiv = document.createElement("div");
        peopleDiv.appendChild(document.createTextNode("報名人數："+_itinerary.numberOfCustomer));
        
        
        var rentalPrice = _itinerary.gear.calPrice();
        var totalPrice = _itinerary.offer + rentalPrice;
        var priceText = "報價："+ totalPrice +" 元/人 ";
        if(rentalPrice > 0) {
            priceText += "(行程 " + _itinerary.offer +" 元 + 裝備租用 " +rentalPrice+ " 元)";
        }

        var priceDiv = document.createElement("div");
        priceDiv.appendChild(document.createTextNode(priceText));
        
        
        var miscDiv = document.createElement("div");
        miscDiv.appendChild(document.createTextNode("附註：" +_itinerary.getMiscDescription()));
        
        var rentalDiv = document.createElement("div");
        rentalDiv.appendChild(document.createTextNode("裝備："+_itinerary.gear.getDescription()));
        
        cs_order_content_ele.appendChild(typeDiv);
        cs_order_content_ele.appendChild(peopleDiv);
        cs_order_content_ele.appendChild(priceDiv);
        cs_order_content_ele.appendChild(miscDiv);
        cs_order_content_ele.appendChild(rentalDiv);
        cs_order_content_ele.appendChild(rentalDiv);
        cs_order_content_ele.appendChild(getPlainItineraryDiv());
    }

    function getPlainItineraryDiv() {
        var totalDays = _itinerary.dates.length;
        var tmpDiv = document.createElement("div");
       
        for(var i = 0; i < totalDays; i++) {
            
            itineraryItem = _itinerary.dates[i];
            
            // 第幾天
            var dayText = "第 " + (i+1) + " 天";
            
            // 日期顯示
            var dateText = itineraryItem.date.simpleString();
            
            // 巴士
            var busDiv = document.createTextNode("");
            if(i == 0 && _itinerary.goWayBus) {
                busDiv = document.createTextNode("去程巴士");
            }
            
            // 住宿
            var accomText = "";
            if(itineraryItem.accommodation == 1) {
                accomText = "雪場住宿";
            }else if(itineraryItem.accommodation > 1) {
                accomText = "東京住宿";
            }
            var accomDiv = document.createTextNode(accomText);
            
            // 雪票日
            var ticketText = "";
            if(itineraryItem.liftTicket) {
                ticketText = "白馬岩岳纜車票";
            }
            var ticketDiv = document.createTextNode(ticketText);
            
            // 滑雪課程
            var classText = "";
            if(itineraryItem.skiClass == 6) {
                classText = "團體課程 4 小時";
            } else if(itineraryItem.skiClass > 0 && itineraryItem.skiClass < 3) {
                classText = "團體課程 " + (itineraryItem.skiClass*2) + "小時";
            } else if(itineraryItem.skiClass > 2) {
                classText += "私人課程 " + (itineraryItem.skiClass-1) + "小時";
            }
            
            var classDiv = document.createTextNode(classText);
            
            tmpDiv.appendChild(createDayDiv(dayText, dateText, busDiv, accomDiv, ticketDiv, classDiv));
        }
        
        if(_itinerary.type != 3) {
            var busDiv = document.createTextNode("");
            if(_itinerary.returnWayBus) {
                busDiv = document.createTextNode("回程巴士");
            }
            
            var homeDiv = document.createTextNode("溫暖的家");
            var emptyDiv = document.createTextNode("");

            tmpDiv.appendChild(createDayDiv("第 " + (totalDays+1) + " 天", _itinerary.returnDate.simpleString(),  busDiv, homeDiv, emptyDiv, emptyDiv));
        }
        
        return tmpDiv;
    }

    function getEditableItineraryDiv() {
        var tmpDiv = document.createElement("div");
        
        // custom buttons
        tmpDiv.appendChild(createAddRemoveFlightButtonDiv((_itinerary.dates.length > 4), _itinerary.flight));
        
        var totalDays = _itinerary.dates.length;
        
        for(var i = 0; i < totalDays; i++) {
            
            itineraryItem = _itinerary.dates[i];
            
            // 第幾天
            var dayText = "第 " + (i+1) + " 天";
            
            // 日期顯示
            var dateText = itineraryItem.date.simpleString();
            
            // 巴士
            var busDiv = document.createTextNode("");
            if(i == 0 && _itinerary.goWayBus) {
                busDiv = document.createTextNode("去程巴士");
            }
            
            // 住宿
            var accomDiv = document.createTextNode("");
            if(itineraryItem.accommodation == 1 && i < 3) {
                accomDiv = document.createTextNode("雪場住宿");
            } else if(itineraryItem.accommodation == 3){
                accomDiv = createEditableItem("東京住宿", cancelTokyoButtonOnClick);
            } else {
                accomDiv = createEditableAccommodationItem(itineraryItem);
            }
            
            // 雪票日
            var ticketDiv = document.createTextNode("");
            if(itineraryItem.liftTicket && i < 3) {
                ticketDiv = createEditableItem("白馬岩岳纜車票", cancelLiftTicketButtonOnClick);
            }else if(i > 2 && itineraryItem.accommodation == 1){
                ticketDiv = createEditableLiftTicketItem(itineraryItem);
            }
            
            // 滑雪課程
            var classText = "";
            var classDiv = document.createTextNode(classText);
            if(itineraryItem.skiClass == 6 && i < 3) {
                classText = "團體課程 4 小時";
                classDiv = createEditableItem(classText, cancelGroupClassButtonOnClick);
            }else if(i > 0 && itineraryItem.accommodation == 1) {
                classDiv = createEditableClassItem(itineraryItem);
            }

            tmpDiv.appendChild(createDayDiv(dayText, dateText, busDiv, accomDiv, ticketDiv, classDiv));
        }
        
        var busDiv = document.createTextNode("回程巴士");
        tmpDiv.appendChild(createDayDiv("第 " + (totalDays+1) + " 天", _itinerary.returnDate.simpleString(), busDiv, document.createTextNode("溫暖的家"), document.createTextNode(""), document.createTextNode("")));
        
        return tmpDiv;
    }

    function getEditableClassOnlyItineraryDiv() {
        var tmpDiv = document.createElement("div");
        // custom buttons
        tmpDiv.appendChild(createAddRemoveButtonDiv((_itinerary.dates.length > 1)));
        
        var totalDays = _itinerary.dates.length;
        
        for(var i = 0; i < totalDays; i++) {
            
            itineraryItem = _itinerary.dates[i];
            
            // 第幾天
            var dayText = "第 " + (i+1) + " 天";
            
            // 日期顯示
            var dateText = itineraryItem.date.simpleString();
            
            // 住宿
            var accomDiv = document.createTextNode("");
            
            // 雪票日
            var ticketDiv = document.createTextNode("");
            
            // 滑雪課程
            var classDiv = createEditableClassItem(itineraryItem);

            tmpDiv.appendChild(createDayDiv(dayText, dateText, accomDiv, ticketDiv, classDiv));
        }
        return tmpDiv;
    }

    function getEditableBedAndBusItineraryDiv() {
        var tmpDiv = document.createElement("div");
        // custom buttons
        tmpDiv.appendChild(createAddRemoveBusButtonDiv((_itinerary.dates.length > 1)));
        
        var totalDays = _itinerary.dates.length;
        
        for(var i = 0; i < totalDays; i++) {
            
            itineraryItem = _itinerary.dates[i];
            
            // 第幾天
            var dayText = "第 " + (i+1) + " 天";
            
            // 日期顯示
            var dateText = itineraryItem.date.simpleString();
            
            // 住宿
            var accomDiv = createEditableAccommodationItem(itineraryItem);
            
            // 巴士
            var busDiv = document.createTextNode("");
            if(i == 0) {
                if(_itinerary.goWayBus && _itinerary.returnWayBus) {
                    busDiv = createEditableItem("去程巴士", goWayBusCancelOnClick);
                }else if(_itinerary.goWayBus){
                    busDiv = document.createTextNode("去程巴士");
                }
            }
            
            // 滑雪課程
            var classDiv = document.createTextNode("");

            tmpDiv.appendChild(createDayDiv(dayText, dateText, busDiv, accomDiv, classDiv));
        }
        
        
        var busDiv = document.createTextNode("回程巴士");
        if(_itinerary.returnWayBus && _itinerary.goWayBus) {
            busDiv = createEditableItem("回程巴士", returnWayBusCancelOnClick);
        }else if(!_itinerary.returnWayBus) {
            busDiv = document.createTextNode("");
        }
        
        tmpDiv.appendChild(createDayDiv("第 " + (totalDays+1) + " 天", _itinerary.returnDate.simpleString(), busDiv, document.createTextNode(""), document.createTextNode("")));
        
        return tmpDiv;
    }

    function createAddRemoveButtonDiv(showRemoveButton) {
        var buttonsDiv = document.createElement("div");
        var addButton = document.createElement("input");
        addButton.type = "button";
        addButton.value = "增加一天";
        addButton.onclick = addOneDayButtonOnClick;
        buttonsDiv.appendChild(addButton);
        
        if(showRemoveButton) {
            var removeButton = document.createElement("input");
            removeButton.type = "button";
            removeButton.value = "減少一天";
            removeButton.onclick = removeOneDayButtonOnClick;
            buttonsDiv.appendChild(removeButton);
        }
        
        return buttonsDiv;
    }

    function createAddRemoveFlightButtonDiv(showRemoveButton, isFlight) {
        var buttonsDiv = document.createElement("div");
        var addButton = document.createElement("input");
        addButton.type = "button";
        addButton.value = "增加一天";
        addButton.onclick = addOneDayButtonOnClick;
        buttonsDiv.appendChild(addButton);
        
        if(showRemoveButton) {
            var removeButton = document.createElement("input");
            removeButton.type = "button";
            removeButton.value = "減少一天";
            removeButton.onclick = removeOneDayButtonOnClick;
            buttonsDiv.appendChild(removeButton);
        }

        buttonsDiv.appendChild(document.createTextNode("退機票"));
        
        var flightCheckbox = document.createElement("input");
        flightCheckbox.type = "checkbox";
        flightCheckbox.checked = !isFlight;
        flightCheckbox.onclick = cancelFlightCheckBoxOnClick;
        buttonsDiv.appendChild(flightCheckbox);
        
        var resetButton = document.createElement("input");
        resetButton.type = "button";
        resetButton.value = "Reset";
        resetButton.onclick = function() {
            customRadioButtonOnClick();
        };
        buttonsDiv.appendChild(resetButton);

        return buttonsDiv;
    }

    function createAddRemoveBusButtonDiv(showRemoveButton) {
        var buttonsDiv = document.createElement("div");
        var addButton = document.createElement("input");
        addButton.type = "button";
        addButton.value = "增加一天";
        addButton.onclick = addOneDayButtonOnClick;
        buttonsDiv.appendChild(addButton);
        
        if(showRemoveButton) {
            var removeButton = document.createElement("input");
            removeButton.type = "button";
            removeButton.value = "減少一天";
            removeButton.onclick = removeOneDayButtonOnClick;
            buttonsDiv.appendChild(removeButton);
        }

        
        var resetButton = document.createElement("input");
        resetButton.type = "button";
        resetButton.value = "reset";
        resetButton.onclick = function() {
            bedAndBusRadioButtonOnClick();
        };
        buttonsDiv.appendChild(resetButton);
        
        return buttonsDiv;
    }

    // Create a div block represent a itinerary date
    function createDayDiv(day, date) {
        var dayDiv = document.createElement("div");
        var labelColor = "#58ACFA";
        var labelTextColor = "#FFFFFF";
        var titleColor = "#F7F2E0";
        var titleTextColor = labelColor;
        
        
        dayDiv.style.backgroundColor = "#F5ECCE";
        dayDiv.style.marginTop = "5px";
        
        var table = document.createElement("table");
        table.style.width = "100%";
        var tr = document.createElement("tr");
        var td1 = document.createElement("td");
        td1.style.textAlign = "center";
        td1.style.backgroundColor = labelColor;
        td1.style.width = "50px";
        td1.style.font = "bold 15px arial,serif";
        td1.style.color = labelTextColor;
        var td2 = document.createElement("td");
        td2.style.textAlign = "center";
        td2.style.font = "bold 20px arial,serif";
        td2.style.backgroundColor = titleColor;
        td2.style.color = titleTextColor;
        
        
        td1.appendChild(document.createTextNode(day));
        td2.appendChild(document.createTextNode(date));
        tr.appendChild(td1);
        tr.appendChild(td2);
        table.appendChild(tr);
        
        for(var i = 2; i< arguments.length;i++) {
            tr = document.createElement("tr");
            td1 = document.createElement("td");
            td1.style.backgroundColor = labelColor;
            td2 = document.createElement("td");
            td2.appendChild(arguments[i]);
            tr.appendChild(td1);
            tr.appendChild(td2);
            table.appendChild(tr);
        }
        
        dayDiv.appendChild(table);
        
        return dayDiv;
    }

    function createDayDiv2(day, date, accommodation, ticket, skiClass) {
        var dayDiv = document.createElement("div");
        var labelColor = "#58ACFA";
        var labelTextColor = "#FFFFFF";
        var titleColor = "#F7F2E0";
        var titleTextColor = labelColor;
        
        
        dayDiv.style.backgroundColor = "#F5ECCE";
        dayDiv.style.marginTop = "5px";
        
        var table = document.createElement("table");
        table.style.width = "100%";
        var tr = document.createElement("tr");
        var td1 = document.createElement("td");
        td1.style.textAlign = "center";
        td1.style.backgroundColor = labelColor;
        td1.style.width = "50px";
        td1.style.font = "bold 15px arial,serif";
        td1.style.color = labelTextColor;
        var td2 = document.createElement("td");
        td2.style.textAlign = "center";
        td2.style.font = "bold 20px arial,serif";
        td2.style.backgroundColor = titleColor;
        td2.style.color = titleTextColor;
        
        
        td1.appendChild(document.createTextNode(day));
        td2.appendChild(document.createTextNode(date));
        tr.appendChild(td1);
        tr.appendChild(td2);
        table.appendChild(tr);
        
        tr = document.createElement("tr");
        td1 = document.createElement("td");
        td1.style.backgroundColor = labelColor;
        td2 = document.createElement("td");
        td2.appendChild(accommodation);
        tr.appendChild(td1);
        tr.appendChild(td2);
        table.appendChild(tr);
        
        tr = document.createElement("tr");
        td1 = document.createElement("td");
        td1.style.backgroundColor = labelColor;
        td2 = document.createElement("td");
        td2.appendChild(ticket);
        tr.appendChild(td1);
        tr.appendChild(td2);
        table.appendChild(tr);
        
        tr = document.createElement("tr");
        td1 = document.createElement("td");
        td1.style.backgroundColor = labelColor;
        td2 = document.createElement("td");
        td2.appendChild(skiClass);
        tr.appendChild(td1);
        tr.appendChild(td2);
        table.appendChild(tr);
        
       
        
        dayDiv.appendChild(table);
        
        return dayDiv;
    }

    function createEditableItem(itemText, onClickFunc) {
        var div = document.createElement("div");
        var textSpan = document.createElement("span");
        textSpan.appendChild(document.createTextNode(itemText));
        var editButton = document.createElement("input");
        editButton.type = "button";
        editButton.value = "取消";
        editButton.onclick = onClickFunc;
        div.appendChild(textSpan);
        div.appendChild(editButton);
        
        return div;
    }

    function createEditableAccommodationItem(itineraryItem) {
        var div = document.createElement("div");
        var selectButton = document.createElement("select");
        var option1 = document.createElement("option");
        option1.innerHTML = "無住宿";
        option1.value = 0;
        var option2 = document.createElement("option");
        option2.innerHTML = "雪場住宿";
        option2.value = 1;
        var option3 = document.createElement("option");
        option3.innerHTML = "東京住宿";
        option3.value = 2;
        selectButton.appendChild(option1);
        selectButton.appendChild(option2);
        selectButton.appendChild(option3);
        selectButton.onchange = function() {
            itineraryItem.accommodation = this.selectedIndex;
            updateAll();
        };
        selectButton.selectedIndex = itineraryItem.accommodation;

        div.appendChild(selectButton);
        
        return div;
    }

    function createEditableLiftTicketItem(itineraryItem) {
        var div = document.createElement("div");
        var selectButton = document.createElement("select");
        var option1 = document.createElement("option");
        option1.innerHTML = "無雪票";
        option1.value = 0;
        var option2 = document.createElement("option");
        option2.innerHTML = "白馬岩岳纜車票";
        option2.value = 1;
        selectButton.appendChild(option1);
        selectButton.appendChild(option2);
        selectButton.onchange = function() {
            itineraryItem.liftTicket = (this.selectedIndex == 1);
            updateAll();
        };
        selectButton.selectedIndex = (itineraryItem.liftTicket ? 1 : 0);
        
        div.appendChild(selectButton);
        
        return div;
    }

    function createEditableClassItem(itineraryItem) {
        var div = document.createElement("div");
        var selectButton = document.createElement("select");
        var option0 = document.createElement("option");
        option0.innerHTML = "無滑雪課程";
        option0.value = 0;
        var option1 = document.createElement("option");
        option1.innerHTML = "團體課程 2 小時 (半天)";
        option1.value = 2;
        var option2 = document.createElement("option");
        option2.innerHTML = "團體課程 4 小時 (整天)";
        option2.value = 4;
        var option3 = document.createElement("option");
        option3.innerHTML = "私人課程 2 小時";
        option3.value = 2;
        var option4 = document.createElement("option");
        option4.innerHTML = "私人課程 3 小時";
        option4.value = 3;
        var option5 = document.createElement("option");
        option5.innerHTML = "私人課程 4 小時";
        option5.value = 4;
        selectButton.appendChild(option0);
        selectButton.appendChild(option1);
        selectButton.appendChild(option2);
        selectButton.appendChild(option3);
        selectButton.appendChild(option4);
        selectButton.appendChild(option5);
        selectButton.onchange = function() {
            itineraryItem.skiClass = this.selectedIndex;
            updateAll();
        };
        
        selectButton.selectedIndex = itineraryItem.skiClass;
        
        div.appendChild(selectButton);
        
        return div;
    }



    /****** Tool Functions ******/
    function priceFinetune(price) {
        var newprice = price;
        if(newprice < 0) {
            newprice = 0;
        }
        var str = "" + parseInt(newprice);
        if(str.length > 3) {
            
            var headStr = str.substring(0, str.length-3);
            var tailStr = str.substring(str.length-3, str.length);
            var tailPrice = parseInt(tailStr);
            
            if(tailPrice > 900) {
                var headPrice = parseInt(headStr);
                newprice = (headPrice+1)*1000;
            }else if(tailPrice == 0) {
                newprice = parseInt(headStr + "000");
            }else{
                newprice = parseInt(headStr + "900");
            }
        }
        
        return newprice;
    }

    function searchDate(date, datalist) {
        for(var idx in datalist) {
            var record = datalist[idx];
            
            if(record[0].indexOf(date) > -1) {
                return record;
            }
        }
        
        return 0;
    }

    // Ajax function to load csv
    function loadCsvData(url, callback) {
        $.get(url, function(data, status){
              _basePriceList = CSVToArray(data,",");
              callback();
              });
    }

    // Calculate date
    Date.prototype.addDays = function(days)
    {
        var dat = new Date(this.valueOf());
        dat.setDate(dat.getDate() + days);
        return dat;
    }

    // Date to format YYYY/MM/dd
    Date.prototype.simpleString = function()
    {
        return this.getFullYear() + "/" + (this.getMonth()+1) + "/" + this.getDate();
    }

    Date.prototype.simpleStringWithWeek = function()
    {
        var weekInCn = "";
        if(this.getDay() == 0) {
            weekInCn = "日";
        }else if(this.getDay() == 1) {
            weekInCn = "一";
        }else if(this.getDay() == 2) {
            weekInCn = "二";
        }else if(this.getDay() == 3) {
            weekInCn = "三";
        }else if(this.getDay() == 4) {
            weekInCn = "四";
        }else if(this.getDay() == 5) {
            weekInCn = "五";
        }else if(this.getDay() == 6) {
            weekInCn = "六";
        }
        
        return this.simpleString() + " (" + weekInCn + ")";
    }

    Date.prototype.formatTaiwan = function()
    {
        return (this.getFullYear()-1911) + " 年 " + (this.getMonth()+1) + " 月 " + this.getDate() + " 日";
    }

    // Date to format MM/dd/YYYY
    Date.prototype.mmddyyyy = function()
    {
        var year = this.getFullYear();
        var month = this.getMonth()+1;
        var day = this.getDate();
        if( day < 10 ) {
            day = "0" + day;
        }
        return  (month + "/" + day + "/" + year) ;
    }

    // Convert csv file to 2d array
    function CSVToArray( strData, strDelimiter ){
        // Check to see if the delimiter is defined. If not,
        // then default to comma.
        strDelimiter = (strDelimiter || ",");
        
        // Create a regular expression to parse the CSV values.
        var objPattern = new RegExp(
                                    (
                                     // Delimiters.
                                     "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +
                                     
                                     // Quoted fields.
                                     "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +
                                     
                                     // Standard fields.
                                     "([^\"\\" + strDelimiter + "\\r\\n]*))"
                                     ),
                                    "gi"
                                    );
                                    
                                    
                                    // Create an array to hold our data. Give the array
                                    // a default empty first row.
                                    var arrData = [[]];
                                    
                                    // Create an array to hold our individual pattern
                                    // matching groups.
                                    var arrMatches = null;
                                    
                                    
                                    // Keep looping over the regular expression matches
                                    // until we can no longer find a match.
                                    while (arrMatches = objPattern.exec( strData )){
                                        
                                        // Get the delimiter that was found.
                                        var strMatchedDelimiter = arrMatches[ 1 ];
                                        
                                        // Check to see if the given delimiter has a length
                                        // (is not the start of string) and if it matches
                                        // field delimiter. If id does not, then we know
                                        // that this delimiter is a row delimiter.
                                        if (
                                            strMatchedDelimiter.length &&
                                            strMatchedDelimiter !== strDelimiter
                                            ){
                                            
                                            // Since we have reached a new row of data,
                                            // add an empty row to our data array.
                                            arrData.push( [] );
                                            
                                        }
                                            
                                            var strMatchedValue;
                                            
                                            // Now that we have our delimiter out of the way,
                                            // let's check to see which kind of value we
                                            // captured (quoted or unquoted).
                                            if (arrMatches[ 2 ]){
                                                
                                                // We found a quoted value. When we capture
                                                // this value, unescape any double quotes.
                                                strMatchedValue = arrMatches[ 2 ].replace(
                                                                                          new RegExp( "\"\"", "g" ),
                                                                                          "\""
                                                                                          );
                                                                                          
                                            } else {
                                                
                                                // We found a non-quoted value.
                                                strMatchedValue = arrMatches[ 3 ];
                                                
                                            }
                                            
                                            
                                            // Now that we have our value string, let's add
                                            // it to the data array.
                                            arrData[ arrData.length - 1 ].push( strMatchedValue );
                                    }
                                    
                                    // Return the parsed data.
                                    return( arrData );
    }


</script>

<script type="text/javascript" src="./resource/252313353-formviewer_prd__ja.js"></script>
<script type="text/javascript">H5F.setup(document.getElementById('ss-form'));
          _initFormViewer(
            "[100,,[]\n]\n");</script></div></body></html>